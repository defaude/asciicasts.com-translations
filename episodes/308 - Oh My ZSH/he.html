<p>
 בתור תכנתי Rails, אנו משתמשים לעיתים קרובות בפקודות טקסט בטרמינל, אך לא תמיד מפיקים מכך את המירב האפשרי. כברירת מחדל, המעטפת הפעילה ברוב הטרמינלים במערכות מבוססות UNIX היא Bash. אחד הדברים הטובים ביותר שתוכלו לעשות, הוא לעבור מBash ל <a href="http://zsh.sourceforge.net/">Z Shell</a> (ידוע גם בתור zsh). מעבר זה יכול להיתו מעט קשה לביצוע, אבל קיים פרויקט הנקרא <a href="https://github.com/robbyrussell/oh-my-zsh">oh-my-zsh</a> אשר הופך את התקנת zsh לקלה ומהירה, וכלל מספר הגדרות ברירת מחדל, ואף מספר תוספים (plugins). כל הנדרש על מנת לבצע את המעבר הוא להריץ את הפקודה הבאה בטרמינל:
 </p>
 
 ``` terminal
wget --no-check-certificate https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh
```
<p>
אם לא מותקן אצלינו wget, ניתן להשתמש ב-curl כדי להתקין את zsh באמצעות הפקודה האלטרנטיבית:
</p>

``` terminal
curl -L https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh | sh
```

<p>
פקודות אלו יעתיקו אלינו את הקוד של oh-my-zsh ויתקין את zsh. בתהליך זה נידרש להכניס את הסיסמה שלנו. לאחר שההתקנה תסתיים, נוכל לפתוח חלון טרמינל חדש, ואנו אמורים לקבל חלון zsh.
</p>

<div class="imageWrapper">
  <img src="http://asciicasts.com/system/photos/907/original/E308I01.png" width="585" height="210" alt="A new zsh terminal window."/>
</div>

<p>
הדבר הראשון שנשים לב אליו, הוא שינוי מהותי במראה של שורת הפקודה. ניתן להתאים את המראה דרך הגדרות תמה (theme) ונראה זאת בהמשך. למרות שבמבט ראשון zsh נראה שונה, רוב הזמן הוא מתנהג בדיוק כמו Bash והפקודות אשר פעלו ב-Bash יפעלו ב-zsh בדיוק באותה הצורה. 
</p>

<h3>מבט מהיר על תכונות zsh</h3>

<p>
אחת התכונות המועילות ביותר של zsh היא השלמה אוטומטית. לדוגמה, אם נקליד <code>ls -</code> ונלחץ על כפתור טאב במקלדת, נקבל רשימה של כל האופציות שניתן להזין ל-<code>ls</code>. ניתן אפילו להשתמש בחיצים על מנת לגלול בתוך הרשימה ולהשלים את הפקודה שאני מקישים בשורת הפקודה. תכונה זו הופכת לשימושית במיוחד עבור פקודות סבוכות, כדוגמת <code>git commit</code>. 
</p>


```` terminal
?  ~  git commit -
--all              -a  -- update all paths in the index file                  
--allow-empty          -- allow recording an empty commit                     
--amend                -- amend the tip of the current branch                 
--author               -- override the author name used in the commit         
--cleanup              -- specify how the commit message should be cleaned up 
--edit             -e  -- edit the commit message before committing           
--file             -F  -- read commit message from given file                 
--include          -i  -- update the given files and commit the whole index   
--interactive          -- interactively update paths in the index file        
--message          -m  -- use the given message as the commit message         
--no-verify        -n  -- do not look for suspicious lines the commit introduc
--only             -o  -- commit only the given files                         
--quiet            -q  -- suppress commit summary message                     
--reedit-message   -c  -- use existing commit object and edit log message     
--reuse-message    -C  -- use existing commit object with same log message    
--signoff          -s  -- add Signed-off-by line at the end of the commit mess
--untracked-files  -u  -- show files in untracked directories                 
--verbose          -v  -- show unified diff of all file changes
```

<p>
תכונה יעילה נוספת היא היכולת להגדיר אפשרויות נרחבות יותר לשימוש בתו חופשי (wildcard). לדוגמה, אם נרצה לקבל רשימה של כל קבצי ה-ruby בפרויקט שלנו, נוכל להשתמש בכוכבית כפולה (**) על מנת לבצע חיפוש רקורסיבי עמוק בתוך התיקיה, בשונה מחיפוש שטוח ב-Bash.
</p>


``` terminal
?  railscasts git:(master) ls **/*.rb
app/controllers/application_controller.rb
app/controllers/comments_controller.rb
app/controllers/episodes_controller.rb
app/controllers/feedback_messages_controller.rb
app/controllers/info_controller.rb
app/controllers/users_controller.rb
app/controllers/versions_controller.rb
app/helpers/application_helper.rb
app/helpers/comments_helper.rb
app/helpers/episodes_helper.rb
app/helpers/error_messages_helper.rb
app/helpers/feedback_messages_helper.rb

# rest of files omitted.
```

<p>
קיימות תכונות נהדרות נוספות ב-zsh. חלק מהן נתמך רק ב-OS X. לדוגמה - הוספת מידע מורחב לכותרת החלון הכולל את המשתמש הנוכחי, המכונה ותיקיית העבודה. 
</p>

<div class="imageWrapper">
  <img src="http://asciicasts.com/system/photos/908/original/E308I02.png" width="585" height="210" alt="The window's title shows information about the user, machine and current directory."/>
</div>

<p>
קיימות תכונות קטנות ויעילות נוספות. למשל, אם נפתח טאב טרמינל חדש, הוא ייפתח באותה תיקייה כמו הטאב הקודם. כמו-כן, אם נתחיל להקליד פקודה ונלחץ על חץ למעלה (במקלדת), נקבל השלמה אוטומטית מהיסטוריית ההקלדה שלנו, מפולטרת על פי הפקודה הנוכחית.
</p>

<h3>הגדרת zsh</h3>

<p>
כל התכונות לעיל ניתנות להגדרה והתאמה, ולכן זה הדבר הבא שנסתכל עליו. קיים קובץ הנקרא <code>.zshrc</code> בתיקיית הבית שלנו והוא נטען בכל פעם שאנו מתחילים סשין חדש של zsh.
</p>

``` ~/.zshrc
# Path to your oh-my-zsh configuration.
ZSH=$HOME/.oh-my-zsh

# Set name of the theme to load.
# Look in ~/.oh-my-zsh/themes/
# Optionally, if you set this to "random", it'll load a random theme each
# time that oh-my-zsh is loaded.
ZSH_THEME="robbyrussell"

# Set to this to use case-sensitive completion
# CASE_SENSITIVE="true"

# Comment this out to disable weekly auto-update checks
# DISABLE_AUTO_UPDATE="true"

# Uncomment following line if you want to disable colors in ls
# DISABLE_LS_COLORS="true"

# Uncomment following line if you want to disable autosetting terminal title.
# DISABLE_AUTO_TITLE="true"

# Uncomment following line if you want red dots to be displayed while waiting for completion
# COMPLETION_WAITING_DOTS="true"

# Which plugins would you like to load? (plugins can be found in ~/.oh-my-zsh/plugins/*)
# Example format: plugins=(rails git textmate ruby lighthouse)
plugins=(git)

source $ZSH/oh-my-zsh.sh

# Customize to your needs...
export PATH=/Users/eifion/.rvm/gems/ruby-1.9.2-p290/bin:/Users/eifion/.rvm/gems/ruby-1.9.2-p290@global/bin:/Users/eifion/.rvm/rubies/ruby-1.9.2-p290/bin:/Users/eifion/.rvm/bin:/Users/eifion/bin:/usr/local/bin:/usr/local/mysql/bin/:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin
```

<p>
ראשית, הקובץ מגדיר את הנתיב לתיקיית ההגדרות של oh-my-zsh. לאחר מכן הוא קובע את התמה, אשר כרגע היא <code>robbyrussel</code>. מתחת לזאת, יש מספר אפשרויות אשר מסומנת כרגע כהערות. כך, אם נרצה למשל, לנטרל את השימוש בצבעים בעת הצגת תיקיות ב-zsh, נוכל למחוק את סימן ההערה (#) בראשית השורה <code>DISABLE_LS_COLORS</code>
</p>

<p>
בהמשך הקובץ קיימת רשימה של כל התוספים המופעלים. כרגע רק <code>git</code> מופעל, אך נוסיף אחרים בעוד מספר רגעים. מתחת לכך, השורה <code>source $ZSH/oh-my-zsh.sh</code> טוענת את oh-my-zsh ולסיום הפקודה אשר קובעת את הנתיב שלנו - <code>PATH</code>. ברירת המחדל לנתיב היא הערך שהיה בשימוש בעת ההתקנה, אולם כנראה עדיף פשוט למשוך זאת מתוך פרופיל ה-Bash שלנו. ניתן לעשות זאת על ידי הסרת השורה המתחילה ב-<code>export PATH</code> מהקובץ <code>.zshrc</code> ולאחר מכן הרצת הפקודה הבאה.
</p>


``` terminal	
?  ~  cat ~/.bash_profile >> ~/.zshrc
```

<p>
מן הסתם, הגדרות אלה יהיו שונות עבור המכונה שלך. ברוב המקרים לא אמורה להיות בעיה להעתיק הגדרות אלה ישירות מBash אולם לעיתים יהיה צורך בהתאמות ותיקונים ידניים קלים על מנת שהכל יעבוד.
</p>

<h3>תמות</h3>

<p>
כעת נגדיר תמה (theme) חדשה כדי לשנות את המראה של שורת הפקודה. התמות הקיימים נמצאות תחת התיקייה <code>~/.oh-my-zsh/themes</code>, ויש לא מעט כאלו בהתקנה הבסיסית. ניתן לראות את רשימת התמות הכלולות בהתקנה יחד עם צילומי מסך, בעמוד ה-Wiki של הפרויקט - <a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Themes">oh-my-zsh wiki page</a>. אם נרצה להתאים את oh-my-zsh בצורה מקיפה, נוכל ליצור תמה משלנו, על ידי יצירת קובץ <code>zsh-theme</code> חדש בתיקיית התמות - וזה מה שנעשה כעת.
</p>


``` ~/oh-my-zsh/themes/eifion.zsh-theme
PROMPT='%3~$(git_prompt_info)%#'

ZSH_THEME_GIT_PROMPT_PREFIX="["
ZSH_THEME_GIT_PROMPT_SUFFIX="]"
```

<p>
התמה שלנו בסיסית למדי כרגע. כל שעשינו הוא לקבוע את פורמט שורת הפקודה ואת הרישא והסיפא שיקיפו את שם הענף הנוכחי שלנו בGit, כאשר אנו נמצאים בתוך תיקייה שהיא פרויקט Git. אם נרצה לבצע הגדרה נרחבת יותר, נוכל להציץ בקוד המקור של שאר התמות לשם השראה. כמו כן, קיים אתר מועיל המתעד את <a href="http://www.acm.uiuc.edu/workshops/zsh/prompt/escapes.html">התווים השונים</a> שניתן להעביר כאופציית <code>PROMPT</code>, ומה תפקידם.
כדי לראות את התמה החדשה שלנו, עלינו לשנות את ההגדרה <code>ZSH_THEME</code> בקובץ <code>.zshrc</code> כך שיהיה תואם לתמה הרצויה.
</p>


``` ~/.zshrc
ZSH_THEME="eifion"
```

<h3>תוספים</h3>

<p>
קל להרחיב את zsh באמצעות תוספים. כמו במקרה של תמות, קיימים תוספים רבים הכלולים בהתקנה הבסיסית, תחת התיקייה <code>~/.oh-my-zsh/plugins</code>. לפני שניצור תוסף, כדאי להציץ באחד קיים ולראות כיצד הוא פועל. לשם הדוגמה, נסתכל בתוסף Bundler. התוסף כולל קובץ הנקרא <code>_bundler</code>. אם לתוסף יש קובץ המתחיל בקו תחתון, זה אומר שהוא כולל השלמה אוטומטית לפקודות מסוימות. התוסף של Bundler עושה מספר דברים נוספים, למשל - יצירת מספר קיצורי דרך (aliases) לפקודות נפוצות של Bundler ובנוסף הוא מוודא שמספר פקודות Rails נפוצות מורצות מתוך bundle exec, כך שלא צריך להקליד זאת בכל פעם מחדש. 
</p>

<p>
יש מספר תוספים שמועיל להיעזר בהם. התוסף של <code>brew</code> מוסיף תכונות השלמה אוטומטית שימושיות, וכך גם <code>gem</code>. אחרים, כגון <code>rails3</code> ו-<code>ruby</code> מועילים פחות, וכוללים רק מספר קיצורי דרך. על מנת להוסיף תוספים חדשים, עלינו רק לכלול אותם בפקודה <code>plugins</code> בקובץ <code>.zshrc</code> באופן הבא:
</p>

``` ~/.zshrc
plugins=(git bundler brew gem)
```

<p>
כמובן שנוכל ליצור גם תוספים משל עצמנו. לדוגמה, נניח ואנו שומרים את כל הפרויקטים שלנו בתיקייה <code>~/code</code>, ונאלצים להקליד כל פעם מחדש <code>cd ~/code/&lt;project&gt;</code> כדי להיכנס לתיקייה של פרויקט ספציפי, מה שקצת מעיק. ניצור כעת פקודה <code>c</code> אשר תאפשר לנו לעבור לתוך תיקיית פרויקט בקלות רבה יותר. ניצור תוסף משלנו בתיקייה <code>~/.oh-my-zsh/custom/plugins</code>. נצטרך ליצור תיקייה לתוסף שלנו וכמו כן את הקובץ <code>.plugin.zsh</code>. 
</p>


``` ~/.oh-my-zsh/custom/plugins/eifion/eifion.plugin.zsh
c() { cd ~/code/$1;  }

_c() { _files -W ~/code -/; }
compdef _c c
```

<p>
השורה הראשונה מגדירה את הפקודה <code>c</code> ופשוט קובעת את תיקיית העבודה לתת התיקייה של התיקייה <code>code</code> אשר הועברה כארגומנט. השורה השניה משפעלת לנו השלמה אוטומטית לפקודה. כדי להוסיף השלמה אוטומטית לפקודה, עלינו ליצור פקודה חדשה בעלת שם זהה אך עם רישא של קו תחתון. הפקודה <code>_c</code> שלנו עושה שימוש בהתנהגות של הפקודה <code>_files</code> להשלמה אוטומטית של הקבצים והתיקיות תחת התיקייה <code>~/code</code>. השורה האחרונה לעיל מגדירה את <code>_c</code> כהשלמה אוטומטית לפקודה <code>c</code>. 
</p>

<p>
על מנת שהתוסף החדש שלנו יפעל, עלינו להוסיף אותו לקובץ <code>.zshrc</code>. 
</p>


``` ~/.zshrc
plugins=(git bundler brew gem eifion)
```

<p>
עלינו לפתוח חלון טרמינל חדש על מנת שהשינויים יופעלו, ואז נוכל להתחיל להשתמש בפקודה החדשה שלנו. 
</p>

<p>
זה הכל לפרק זה על oh-my-zsh. אם אתם משתמשים בטרמינל לעיתים קרובות, כדאי לכם לשקול להחליף את מעטפת ברירת המחדל של המערכת שלכם ב-zsh.
</p>